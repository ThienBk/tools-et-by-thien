<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Excel Safe Semicolon Formatter</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f7f7f7;
    }

    textarea {
      width: 100%;
      height: 180px;
      margin-top: 10px;
      font-family: Consolas, monospace;
      font-size: 14px;
    }

    .buttons {
      margin: 15px 0;
    }

    button {
      padding: 10px 18px;
      font-size: 14px;
      cursor: pointer;
      margin-right: 10px;
    }
  </style>
</head>
<body>

  <h2>Input</h2>
  <textarea id="input" placeholder="Dán dữ liệu từ Excel vào đây..."></textarea>

  <div class="buttons">
    <button onclick="processText()">Xử lý</button>
    <button onclick="copyOutput()">Copy Output</button>
    <button onclick="clearAll()">Xóa toàn bộ</button>
  </div>

  <h2>Output (; only – Excel Safe)</h2>
  <textarea id="output" placeholder="Chỉ dùng dấu ; – không space, không tab"></textarea>

  <script>
    function cleanValue(text) {
      return text
        .replace(/\s+/g, " ") // gom space trong text
        .trim();              // xóa space đầu cuối
    }

    function processText() {
      const input = document.getElementById("input").value;

      const result = input
        .split("\n")
        .map(line => {
          // tách theo TAB hoặc nhiều SPACE
          const parts = line.split(/\t+|\s{2,}/)
                            .map(cleanValue)
                            .filter(Boolean);

          // GHÉP BẰNG DẤU ;
          return parts.join(";");
        })
        .join("\n");

      document.getElementById("output").value = result;
    }

    function copyOutput() {
      const output = document.getElementById("output");
      output.select();
      document.execCommand("copy");
    }

    function clearAll() {
      if (confirm("Xóa toàn bộ dữ liệu?")) {
        document.getElementById("input").value = "";
        document.getElementById("output").value = "";
      }
    }
  </script>

</body>
</html>
